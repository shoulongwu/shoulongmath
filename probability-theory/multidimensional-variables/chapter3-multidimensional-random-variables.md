# 第三章：多维随机变量

## 📋 本章概览

**学习目标**: 掌握多维随机变量的联合分布、边际分布、条件分布及独立性  
**难度等级**: ⭐⭐⭐⭐ (高难度)  
**学习时间**: 建议2-3周  
**考试分值**: 8-12分

---

## 3.1 二维随机变量及其分布

### 3.1.1 二维随机变量的概念

**定义**: 设(Ω, F, P)是概率空间，X(ω)和Y(ω)是定义在Ω上的两个随机变量，则称(X,Y)为**二维随机变量**或**随机向量**。

### 3.1.2 联合分布函数

**定义**: 对任意实数x, y，称
```
F(x,y) = P(X ≤ x, Y ≤ y)
```
为二维随机变量(X,Y)的**联合分布函数**。

### 3.1.3 联合分布函数的性质

1. **有界性**: 0 ≤ F(x,y) ≤ 1
2. **单调性**: F(x,y)关于x和y分别单调不减
3. **右连续性**: F(x,y)关于每个变量右连续
4. **边界性质**:
   ```
   F(-∞,y) = F(x,-∞) = F(-∞,-∞) = 0
   F(+∞,+∞) = 1
   ```
5. **概率计算**:
   ```
   P(x₁ < X ≤ x₂, y₁ < Y ≤ y₂) = F(x₂,y₂) - F(x₁,y₂) - F(x₂,y₁) + F(x₁,y₁)
   ```

---

## 3.2 二维离散型随机变量

### 3.2.1 联合概率质量函数

设(X,Y)的所有可能取值为(xᵢ, yⱼ)，i,j = 1,2,...，则称
```
P(X = xᵢ, Y = yⱼ) = pᵢⱼ
```
为(X,Y)的**联合概率质量函数**。

**性质**:
1. pᵢⱼ ≥ 0
2. ∑ᵢ∑ⱼ pᵢⱼ = 1

### 3.2.2 边际分布

**X的边际分布**:
```
P(X = xᵢ) = ∑ⱼ P(X = xᵢ, Y = yⱼ) = ∑ⱼ pᵢⱼ = pᵢ·
```

**Y的边际分布**:
```
P(Y = yⱼ) = ∑ᵢ P(X = xᵢ, Y = yⱼ) = ∑ᵢ pᵢⱼ = p·ⱼ
```

### 3.2.3 条件分布

**给定Y = yⱼ时X的条件分布**:
```
P(X = xᵢ | Y = yⱼ) = P(X = xᵢ, Y = yⱼ) / P(Y = yⱼ) = pᵢⱼ / p·ⱼ
```

其中P(Y = yⱼ) > 0。

## 🔥 难点解析1：边际分布与条件分布

### 理论基础
- 边际分布是从联合分布中"提取"单个变量的分布
- 条件分布描述在已知一个变量值的条件下另一个变量的分布

### 记忆技巧
- "边际分布是求和，条件分布是比值"
- "边际在边上，条件有前提"

### 详细例题1: 离散型二维随机变量

**题目**: 二维随机变量(X,Y)的联合分布为：

| X\Y | 0 | 1 | 2 |
|-----|---|---|---|
| -1  |0.1|0.2|0.1|
| 0   |0.2|0.1|0.1|
| 1   |0.1|0.1|0.1|

求：(1) 边际分布  (2) P(X=0|Y=1)  (3) P(X+Y=1)

**解析**:

**(1) 边际分布**:

X的边际分布：
- P(X = -1) = 0.1 + 0.2 + 0.1 = 0.4
- P(X = 0) = 0.2 + 0.1 + 0.1 = 0.4  
- P(X = 1) = 0.1 + 0.1 + 0.1 = 0.3

Y的边际分布：
- P(Y = 0) = 0.1 + 0.2 + 0.1 = 0.4
- P(Y = 1) = 0.2 + 0.1 + 0.1 = 0.4
- P(Y = 2) = 0.1 + 0.1 + 0.1 = 0.3

**(2) 条件概率**:
```
P(X = 0 | Y = 1) = P(X = 0, Y = 1) / P(Y = 1) = 0.1 / 0.4 = 0.25
```

**(3) 事件概率**:
X + Y = 1的情况：(-1,2), (0,1), (1,0)
```
P(X + Y = 1) = P(X = -1, Y = 2) + P(X = 0, Y = 1) + P(X = 1, Y = 0)
              = 0.1 + 0.1 + 0.1 = 0.3
```

---

## 3.3 二维连续型随机变量

### 3.3.1 联合概率密度函数

如果存在非负函数f(x,y)，使得对任意实数x, y，有
```
F(x,y) = ∫₋∞ˣ ∫₋∞ʸ f(u,v) dv du
```
则称f(x,y)为(X,Y)的**联合概率密度函数**。

**性质**:
1. f(x,y) ≥ 0
2. ∫₋∞⁺∞ ∫₋∞⁺∞ f(x,y) dx dy = 1
3. P((X,Y) ∈ D) = ∬_D f(x,y) dx dy
4. 在f(x,y)的连续点处：∂²F(x,y)/∂x∂y = f(x,y)

### 3.3.2 边际概率密度函数

**X的边际密度函数**:
```
fₓ(x) = ∫₋∞⁺∞ f(x,y) dy
```

**Y的边际密度函数**:
```
fᵧ(y) = ∫₋∞⁺∞ f(x,y) dx
```

### 3.3.3 条件概率密度函数

**给定Y = y时X的条件密度函数**:
```
f(x|y) = f(x,y) / fᵧ(y), fᵧ(y) > 0
```

**给定X = x时Y的条件密度函数**:
```
f(y|x) = f(x,y) / fₓ(x), fₓ(x) > 0
```

## 🔥 难点解析2：二维连续型分布的计算

### 理论基础
连续型二维随机变量的所有概率计算都归结为二重积分

### 解题策略
1. 确定积分区域
2. 选择合适的积分次序
3. 注意积分限的确定

### 详细例题2: 二维连续型随机变量

**题目**: 设二维随机变量(X,Y)的联合概率密度函数为
```
f(x,y) = {
  2, 0 < x < y < 1
  0, 其他
}
```
求：(1) 边际密度函数  (2) P(X + Y < 1)

**解析**:

**(1) 边际密度函数**:

对于fₓ(x)，当0 < x < 1时：
```
fₓ(x) = ∫₋∞⁺∞ f(x,y) dy = ∫ₓ¹ 2 dy = 2(1-x)
```

所以：
```
fₓ(x) = {
  2(1-x), 0 < x < 1
  0,      其他
}
```

对于fᵧ(y)，当0 < y < 1时：
```
fᵧ(y) = ∫₋∞⁺∞ f(x,y) dx = ∫₀ʸ 2 dx = 2y
```

所以：
```
fᵧ(y) = {
  2y, 0 < y < 1
  0,  其他
}
```

**(2) 概率计算**:
事件{X + Y < 1}在定义域{0 < x < y < 1}内对应的区域是：
{(x,y): 0 < x < y < 1, x + y < 1}

```
P(X + Y < 1) = ∬_D f(x,y) dx dy
              = ∫₀^(1/2) ∫ₓ^(1-x) 2 dy dx
              = ∫₀^(1/2) 2(1-2x) dx
              = 2[x - x²]₀^(1/2)
              = 2[1/2 - 1/4] = 1/2
```

---

## 3.4 随机变量的独立性

### 3.4.1 独立性的定义

二维随机变量(X,Y)的分量X和Y**相互独立**，当且仅当对任意实数x, y，有
```
F(x,y) = Fₓ(x) × Fᵧ(y)
```

### 3.4.2 独立性的等价条件

**离散型**:
```
P(X = xᵢ, Y = yⱼ) = P(X = xᵢ) × P(Y = yⱼ)
```

**连续型**:
```
f(x,y) = fₓ(x) × fᵧ(y)
```

### 3.4.3 独立性的性质

1. 若X与Y独立，则g(X)与h(Y)也独立（g, h为Borel函数）
2. 若X与Y独立，则E[XY] = E[X]E[Y]（如果期望存在）
3. 若X与Y独立，则Var(X ± Y) = Var(X) + Var(Y)

## 🔥 难点解析3：独立性的判断与应用

### 判断方法
1. **定义法**: 验证联合分布是否等于边际分布的乘积
2. **分离变量法**: 看联合密度是否可以写成f₁(x)×f₂(y)的形式
3. **几何法**: 观察概率密度函数的支撑集合

### 常见误区
1. 混淆"独立"与"不相关"
2. 独立性判断时忽略定义域
3. 误认为条件分布等于边际分布就是独立

### 详细例题3: 独立性判断

**题目**: 判断下列二维随机变量的分量是否独立：
```
f(x,y) = {
  6xy, 0 < x < 1, 0 < y < 2-x
  0,   其他
}
```

**解析**:

**第一步**: 求边际密度函数

对于fₓ(x)，当0 < x < 1时：
```
fₓ(x) = ∫₀^(2-x) 6xy dy = 6x[y²/2]₀^(2-x) = 3x(2-x)²
```

对于fᵧ(y)，需要分情况讨论：
- 当0 < y ≤ 1时：积分区域x: 0 → 2-y
- 当1 < y < 2时：积分区域x: 0 → 2-y

```
当 0 < y ≤ 1 时：
fᵧ(y) = ∫₀^(2-y) 6xy dx = 6y[x²/2]₀^(2-y) = 3y(2-y)²

当 1 < y < 2 时：
fᵧ(y) = ∫₀^(2-y) 6xy dx = 3y(2-y)²
```

所以：fᵧ(y) = 3y(2-y)², 0 < y < 2

**第二步**: 检验独立性
```
fₓ(x) × fᵧ(y) = 3x(2-x)² × 3y(2-y)² = 9xy(2-x)²(2-y)²
```

这与f(x,y) = 6xy不相等，因此X与Y不独立。

**几何解释**: 定义域{0 < x < 1, 0 < y < 2-x}不是矩形区域，这通常暗示变量不独立。

---

## 3.5 二维随机变量函数的分布

### 3.5.1 和的分布

设(X,Y)是二维连续型随机变量，Z = X + Y，则Z的概率密度函数为：
```
fᵤ(z) = ∫₋∞⁺∞ f(x, z-x) dx = ∫₋∞⁺∞ f(z-y, y) dy
```

**卷积公式**: 若X与Y独立，则
```
fᵤ(z) = ∫₋∞⁺∞ fₓ(x) fᵧ(z-x) dx = (fₓ * fᵧ)(z)
```

### 3.5.2 最大值和最小值的分布

设X₁, X₂, ..., Xₙ相互独立，分布函数分别为F₁(x), F₂(x), ..., Fₙ(x)。

**最大值**: M = max{X₁, X₂, ..., Xₙ}
```
F_M(x) = F₁(x) × F₂(x) × ... × Fₙ(x)
```

**最小值**: N = min{X₁, X₂, ..., Xₙ}
```
F_N(x) = 1 - [1-F₁(x)] × [1-F₂(x)] × ... × [1-Fₙ(x)]
```

### 3.5.3 商的分布

设(X,Y)是二维连续型随机变量，Z = Y/X，则：
```
fᵤ(z) = ∫₋∞⁺∞ |x| f(x, zx) dx
```

### 3.5.4 雅可比变换

设(X,Y)的联合密度为f(x,y)，通过变换：
```
U = g₁(X,Y)
V = g₂(X,Y)
```

若存在反变换：
```
X = h₁(U,V)
Y = h₂(U,V)
```

且雅可比行列式J ≠ 0，则：
```
f(u,v) = f(h₁(u,v), h₂(u,v)) |J|

其中 J = ∂(x,y)/∂(u,v) = |∂x/∂u  ∂x/∂v|
                        |∂y/∂u  ∂y/∂v|
```

## 🔥 难点解析4：随机变量函数的分布

### 解题策略
1. **简单函数**: 直接用分布函数法
2. **和、差、积、商**: 用专门公式
3. **复杂变换**: 用雅可比变换

### 详细例题4: 和的分布

**题目**: 设X ~ U(0,1)，Y ~ U(0,1)，且X与Y独立。求Z = X + Y的概率密度函数。

**解析**:

由于X和Y独立且都服从U(0,1)，有：
```
fₓ(x) = 1, 0 < x < 1
fᵧ(y) = 1, 0 < y < 1
```

Z = X + Y的取值范围为(0, 2)。

使用卷积公式：
```
fᵤ(z) = ∫₋∞⁺∞ fₓ(x) fᵧ(z-x) dx
```

需要确定积分限。要使fₓ(x) > 0且fᵧ(z-x) > 0，需要：
- 0 < x < 1
- 0 < z-x < 1，即z-1 < x < z

**当0 < z ≤ 1时**：
积分区域为max(0, z-1) < x < min(1, z)，即0 < x < z
```
fᵤ(z) = ∫₀ᶻ 1 × 1 dx = z
```

**当1 < z < 2时**：
积分区域为z-1 < x < 1
```
fᵤ(z) = ∫ᶻ⁻¹¹ 1 × 1 dx = 1-(z-1) = 2-z
```

**最终结果**:
```
fᵤ(z) = {
  z,    0 < z ≤ 1
  2-z,  1 < z < 2
  0,    其他
}
```

这是三角分布，图形呈三角形状。

---

## 📝 本章练习题

### 基础练习 (⭐⭐)

**练习1**: 设二维随机变量(X,Y)的联合分布为：

| X\Y | 1 | 2 | 3 |
|-----|---|---|---|
| 0   |1/6|1/9|1/18|
| 1   |1/3|2/9|1/9 |

求边际分布和P(X=1|Y=2)。

**练习2**: 设(X,Y)的联合密度函数为：
```
f(x,y) = {
  c(x+y), 0 ≤ x ≤ 1, 0 ≤ y ≤ 1
  0,      其他
}
```
求常数c和边际密度函数。

### 提高练习 (⭐⭐⭐)

**练习3**: 设X ~ N(0,1)，Y ~ N(0,1)，且X与Y独立。求：
1. Z₁ = X + Y的分布
2. Z₂ = X - Y的分布
3. Z₃ = X²+ Y²的分布

**练习4**: 设(X,Y)的联合密度为：
```
f(x,y) = {
  2, 0 < x < y < 1
  0, 其他
}
```
判断X与Y是否独立，并求P(X + Y < 1/2)。

### 综合练习 (⭐⭐⭐⭐)

**练习5**: 设(X,Y)服从单位圆内的均匀分布，即：
```
f(x,y) = {
  1/π, x² + y² ≤ 1
  0,   其他
}
```
求X和Y的边际分布。

**练习6**: 设X₁, X₂, X₃相互独立，都服从U(0,1)。求：
1. M = max{X₁, X₂, X₃}的分布函数
2. N = min{X₁, X₂, X₃}的分布函数

---

## 🎯 考试重点总结

### 必考知识点
1. **边际分布的求法** (⭐⭐⭐⭐)
   - 离散型：求和
   - 连续型：积分

2. **独立性的判断** (⭐⭐⭐⭐)
   - 联合分布 = 边际分布乘积
   - 几何直观：矩形支撑集

3. **二维正态分布** (⭐⭐⭐)
   - 标准形式
   - 独立性条件

4. **随机变量函数的分布** (⭐⭐⭐)
   - 和的分布（卷积）
   - 最值分布

### 解题技巧
1. **边际分布**: 画图确定积分区域
2. **独立性**: 先看支撑集是否为矩形
3. **函数分布**: 选择合适的变换方法

### 常见错误
1. 积分区域确定错误
2. 独立性判断时忽略支撑集
3. 雅可比变换时行列式计算错误

---

**下一章预告**: 第四章将学习随机变量的数字特征，包括期望、方差、协方差等重要概念。